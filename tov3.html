<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
      	
      <script src="http://maps.google.com/maps/api/js?sensor=false"
      type="text/javascript"></script>
    <script type="text/javascript">

 function load() {
        var center = new google.maps.LatLng(12.935442,77.534949);
        
        var options={
			zoom:15,
		        center:center,
                        mapTypeId:google.maps.MapTypeId.ROADMAP,
                     };
        var map = new google.maps.Map(document.getElementById("map"),options);
       
        var marker = new google.maps.Marker( {
				draggable: true,
				position:center,
				map:map,
				});  
        marker.setMap(map);
        document.getElementById("lat").innerHTML = center.lat().toFixed(6);
        document.getElementById("lng").innerHTML = center.lng().toFixed(6);

       google.maps.event.addListener(marker, "dragend", function(event) {
         
	var point = event.latLng;
        map.setCenter(point);
       document.getElementById("lat").innerHTML = point.lat().toFixed(6);
       document.getElementById("lng").innerHTML = point.lng().toFixed(6);

        });


	 google.maps.event.addListener(map, "moveend", function(event) {
		  maker.setMap(null);
    var center = map.getCenter();
		  var marker = new GMarker( 
				{draggable: true,
				position:center,
				map:map
				});
		  marker.setMap(map);
		  document.getElementById("lat").innerHTML = center.lat().toFixed(6);
	   document.getElementById("lng").innerHTML = center.lng().toFixed(6);


	
       google.maps.event.addListener(marker, "dragend", function(event) {
         
	var point = event.latLng;
        map.setCenter(point);
       document.getElementById("lat").innerHTML = point.lat().toFixed(6);
       document.getElementById("lng").innerHTML = point.lng().toFixed(6);

        });
 
        });

      
    }

	   function showAddress(address) {
	   var map = new GMap2(document.getElementById("map"));
       map.addControl(new GSmallMapControl());
       map.addControl(new GMapTypeControl());
       if (geocoder) {
        geocoder.getLatLng(
          address,
          function(point) {
            if (!point) {
              alert(address + " not found");
            } else {
		  document.getElementById("lat").innerHTML = point.lat().toFixed(5);
	   document.getElementById("lng").innerHTML = point.lng().toFixed(5);
		 map.clearOverlays()
			map.setCenter(point, 14);
   var marker = new GMarker(point, {draggable: true});  
		 map.addOverlay(marker);

		GEvent.addListener(marker, "dragend", function() {
      var pt = marker.getPoint();
	     map.panTo(pt);
      document.getElementById("lat").innerHTML = pt.lat().toFixed(5);
	     document.getElementById("lng").innerHTML = pt.lng().toFixed(5);
        });


	 GEvent.addListener(map, "moveend", function() {
		  map.clearOverlays();
    var center = map.getCenter();
		  var marker = new GMarker(center, {draggable: true});
		  map.addOverlay(marker);
		  document.getElementById("lat").innerHTML = center.lat().toFixed(5);
	   document.getElementById("lng").innerHTML = center.lng().toFixed(5);

	 GEvent.addListener(marker, "dragend", function() {
     var pt = marker.getPoint();
	    map.panTo(pt);
    document.getElementById("lat").innerHTML = pt.lat().toFixed(5);
	   document.getElementById("lng").innerHTML = pt.lng().toFixed(5);
        });
 
        });

            }
          }
        );
      }
    }
    </script>
  </head>

  
<body onload="load()" onunload="GUnload()" >



  <form action="#" onsubmit="showAddress(this.address.value); return false">
     <p>        
      <input type="text" size="60" name="address" value="pesit,bangalore" />
      <input type="submit" value="Search!" />
      </p>
    </form>

 <p align="left">

 
 <table  bgcolor="#FFFFCC" width="300">
  <tr>
    <td width="100"><b>Latitude</b></td>
    <td id="lat"></td>
  </tr>
  <tr>
    <td width="100"><b>Longitude</b></td>

    <td id="lng"></td>

  </tr>
</table>
 </p>
  <p>
  <div align="center" id="map" style="width: 600px; height: 400px"><br/></div>
   </p>
  </div>

  </body>

</html>

